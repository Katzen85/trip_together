<%= render "shared/trip_header"%>

<h2>Places</h2>

<div class="container">

  <div class="col">
    <h3>Vote for the places you're interested in visiting </h3>

    <br>

    <div class="vote-line">
      <div class="vote circle">
        <div class="increment up"></div>
        <div class="increment down"></div>
        <div class="count">0</div>
      </div>
      <div>
        <div class="card mb-3" style="max-width: 540px;">
          <div class="row no-gutters">
            <div class="col-md-4">
              <img
                src="https://images.unsplash.com/photo-1545289763-1a46ebc867ea?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=400&q=60"
                class="card-img" alt="...">
            </div>
            <div class="col-md-8">
              <div class="card-body">
                <h5 class="card-title">Botanical Gardens</h5>
                <p class="card-text">This is where a description of the botanical gardens can go</p>
                <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <a href="trips/<%=params[:id]%>/places/edit%" class="badge badge-secondary">Delete</a>
    </div>




  <div class="col">
    <h2>Search for places you want to go to on your trip</h2>

    <div class="md-form active-pink active-pink-2 mb-3 mt-0">
      <form action="" class="search-form">
        <input class="form-control" type="text" placeholder="times square" aria-label="Search" name="searchstring">
        <button type="submit" class="btn-search">Search</button>
      </form>
    </div>

    <ul>
      <li>times square</li>
    </ul>


    <div id="map-container-google-1" class="z-depth-1-half map-container" style="height: 300px">
      <iframe src="https://maps.google.com/maps?q=paris&t=&z=13&ie=UTF8&iwloc=&output=embed" frameborder="0"
        style="border:0" allowfullscreen></iframe>
    </div>

<!--  Code to help with pinning places in-->
    <p>
      <div id="map"></div>
    </p>


    <p>
      <%# <%= image_tag "https://maps.googleapis.com/maps/api/staticmap?zoom=17&size=400x300&center=#{@place.latitude},#{@place.longitude}&key=#{ENV["GOOGLE_API_KEY"]}", alt: "Map" %>
    </p>
  </div>
</div>



<script>
  $(function () {
    $(".increment").click(function () {
      var count = parseInt($("~ .count", this).text());

      if ($(this).hasClass("up")) {
        var count = count + 1;

        $("~ .count", this).text(count);
      } else {
        var count = count - 1;
        $("~ .count", this).text(count);
      }

      $(this).parent().addClass("bump");

      setTimeout(function () {
        $(this).parent().removeClass("bump");
      }, 400);
    });
  });

  var btnSearch = document.querySelector('.btn-search')
  var ul = document.querySelector('ul')
  var input = document.querySelector('input')
  var searchFrom = document.querySelector('.search-form')

  searchFrom.addEventListener('submit', (event) => {
    event.preventDefault()
    searchstring = $('.form-control')[0].value
    // var place = input.value

    $.ajax(`/api/places/search?searchstring=${searchstring}`).done(response => {
    response.candidates.forEach(place => {
      // var h1 = document.createElement('h1')
      // h1.innerHTML = place.name
      // var h3 = document.createElement('h3')
      // h3.innerHTML = place.rating
      // document.body.appendChild(h1)
      // document.body.appendChild(h3)
      var li = document.createElement('li')
      ul.appendChild(li)
      li.textContent = place.name

    // <button type="button" class="btn btn-secondary place-submit-btn" data-toggle="tooltip" data-placement="bottom" title="Tooltip on bottom">
    //   Add Place
    // </button>


          // place.name
          // place.formatted_address
          // place.rating
          // place.types(this is an array)
        })
      })
  })
</script>